<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login Power BI</title>

  <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet"/>
  <link rel="stylesheet" href="acesso.css" />
</head>

<body>
  <main class="auth-page">

    <!-- LADO ESQUERDO (degradê + login) -->
    <section class="auth-left">
      <div class="brand">
        <div class="brand-badge"><i class='bx bxs-bulb'></i></div>
        <div class="brand-text">
          <h2>Central de Dados</h2>
          <p>Indicadores e dashboards da companhia</p>
        </div>
      </div>

      <div class="login-card">
        <form id="login-form">
          <h1>Login</h1>

          <div class="input-box">
            <input id="usuario" type="text" placeholder="Usuário" required />
            <i class="bx bxs-user"></i>
          </div>

          <div class="input-box">
            <input id="senha" type="password" placeholder="Senha" required />
            <i class="bx bxs-lock-alt"></i>
          </div>

          <div class="remember-forgot">
            <label><input type="checkbox" /> Lembrar senha</label>
            <a href="#">Esqueci a senha</a>
          </div>

          <button type="submit" class="Login">Entrar</button>
        </form>
      </div>

      <p class="footer-note">© 2026 • Iluminação & Dados</p>
    </section>

    <!-- LADO DIREITO (imagem) -->
    <section class="auth-right">
      <!-- Se quiser usar <img> ao invés de background, descomente abaixo:
      <img class="hero-img" src="imagem.jpg" alt="Ilustração" />
      -->
    </section>

  </main>

  <script>
    const urlBackend = "https://dashboard-grupo.onrender.com"; // base do backend

    document.getElementById("login-form").addEventListener("submit", async function (e) {
      e.preventDefault();

      const usuario = document.getElementById("usuario").value.trim();
      const senha = document.getElementById("senha").value.trim();

      try {
        const resposta = await fetch(`${urlBackend}/login`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ usuario, senha })
        });

        const dados = await resposta.json();

        if (resposta.ok && dados.success) {
          const nivel = Number(dados.nivel_permissao);

          localStorage.setItem("usuario", usuario);
          localStorage.setItem("nivel_permissao", nivel);

          window.location.replace("segunda tela.html");
        } else {
          alert(dados.mensagem || "Usuário ou senha incorretos.");
        }
      } catch (erro) {
        alert("Erro ao conectar com o servidor.");
        console.error(erro);
      }
    });
  </script>
</body>
</html>
